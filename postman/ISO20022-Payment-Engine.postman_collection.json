{
	"info": {
		"_postman_id": "payment-engine-iso20022",
		"name": "Payment Engine - ISO20022 Golden Path",
		"description": "Complete ISO20022 message flow testing: Ingest → Validate → Persist → Publish → Acknowledge",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{jwt_token}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Set base URL if not already set",
					"if (!pm.variables.get('base_url')) {",
					"    pm.variables.set('base_url', 'http://localhost:8081');",
					"}",
					"",
					"// Set tenant ID if not set",
					"if (!pm.variables.get('tenantId')) {",
					"    pm.variables.set('tenantId', 'tenant-001');",
					"}"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8082",
			"type": "string"
		},
		{
			"key": "tenantId",
			"value": "tenant-001",
			"type": "string"
		},
		{
			"key": "jwt_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "messageId",
			"value": "",
			"type": "string"
		},
		{
			"key": "correlationId",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "1. Authentication",
			"item": [
				{
					"name": "Login & Get JWT Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Token is present', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.token).to.exist;",
									"    pm.variables.set('jwt_token', jsonData.token);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{base_url}}/payment-processing/api/auth/admin-token",
							"host": ["{{base_url}}"],
							"path": ["payment-processing", "api", "auth", "admin-token"]
						}
					}
				}
			]
		},
		{
			"name": "2. ISO20022 Golden Path - PAIN.001",
			"item": [
				{
					"name": "1. Ingest PAIN.001 (Customer Credit Transfer)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Message ID is present', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.messageId).to.exist;",
									"    pm.variables.set('messageId', jsonData.messageId);",
									"    pm.variables.set('correlationId', jsonData.correlationId);",
									"});",
									"",
									"pm.test('Status is SUCCESS', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql('SUCCESS');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"CstmrCdtTrfInitn\": {\n        \"GrpHdr\": {\n            \"MsgId\": \"MSG-{{$timestamp}}\",\n            \"CreDtTm\": \"{{$isoTimestamp}}\",\n            \"NbOfTxs\": \"1\",\n            \"CtrlSum\": 1000.00,\n            \"InitgPty\": {\n                \"Nm\": \"Acme Corporation\",\n                \"Id\": {\n                    \"OrgId\": {\n                        \"Othr\": {\n                            \"Id\": \"ACME001\"\n                        }\n                    }\n                }\n            }\n        },\n        \"PmtInf\": {\n            \"PmtInfId\": \"PMT-{{$timestamp}}\",\n            \"PmtMtd\": \"TRF\",\n            \"ReqdExctnDt\": \"2025-10-11\",\n            \"Dbtr\": {\n                \"Nm\": \"John Doe\",\n                \"PstlAdr\": {\n                    \"Ctry\": \"US\"\n                }\n            },\n            \"DbtrAcct\": {\n                \"Id\": {\n                    \"IBAN\": \"US64SVBKUS6S3300958879\"\n                }\n            },\n            \"DbtrAgt\": {\n                \"FinInstnId\": {\n                    \"BIC\": \"SVBKUS6S\"\n                }\n            },\n            \"CdtTrfTxInf\": {\n                \"PmtId\": {\n                    \"EndToEndId\": \"E2E-{{$timestamp}}\",\n                    \"TxId\": \"TXN-{{$timestamp}}\"\n                },\n                \"Amt\": {\n                    \"InstdAmt\": {\n                        \"Ccy\": \"USD\",\n                        \"Value\": 1000.00\n                    }\n                },\n                \"Cdtr\": {\n                    \"Nm\": \"Jane Smith\"\n                },\n                \"CdtrAcct\": {\n                    \"Id\": {\n                        \"IBAN\": \"US64SVBKUS6S3300123456\"\n                    }\n                },\n                \"Purp\": {\n                    \"Cd\": \"SALA\"\n                },\n                \"RmtInf\": {\n                    \"Ustrd\": \"Salary payment for September 2025\"\n                }\n            }\n        }\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/payment-processing/api/v1/iso20022/comprehensive/pain001-to-clearing-system?tenantId={{tenantId}}&paymentType=CREDIT_TRANSFER&localInstrumentCode=IMMEDIATE&responseMode=IMMEDIATE",
							"host": ["{{base_url}}"],
							"path": ["payment-processing", "api", "v1", "iso20022", "comprehensive", "pain001-to-clearing-system"],
							"query": [
								{
									"key": "tenantId",
									"value": "{{tenantId}}"
								},
								{
									"key": "paymentType",
									"value": "CREDIT_TRANSFER"
								},
								{
									"key": "localInstrumentCode",
									"value": "IMMEDIATE"
								},
								{
									"key": "responseMode",
									"value": "IMMEDIATE"
								}
							]
						}
					}
				},
				{
					"name": "2. Validate PAIN.001 Message",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Validation is successful', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.success).to.be.true;",
									"    pm.expect(jsonData.validation.valid).to.be.true;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"CstmrCdtTrfInitn\": {\n        \"GrpHdr\": {\n            \"MsgId\": \"MSG-TEST-001\",\n            \"CreDtTm\": \"2025-10-10T12:00:00\",\n            \"NbOfTxs\": \"1\"\n        }\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/payment-processing/api/v1/iso20022/comprehensive/validate?messageType=pain.001",
							"host": ["{{base_url}}"],
							"path": ["payment-processing", "api", "v1", "iso20022", "comprehensive", "validate"],
							"query": [
								{
									"key": "messageType",
									"value": "pain.001"
								}
							]
						}
					}
				},
				{
					"name": "3. Track Message Flow",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Flow history is present', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.success).to.be.true;",
									"    pm.expect(jsonData.data).to.exist;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/payment-processing/api/v1/iso20022/comprehensive/flow-history/{{correlationId}}",
							"host": ["{{base_url}}"],
							"path": ["payment-processing", "api", "v1", "iso20022", "comprehensive", "flow-history", "{{correlationId}}"]
						}
					}
				}
			]
		},
		{
			"name": "3. ISO20022 Transformations",
			"item": [
				{
					"name": "Transform PAIN.001 to PACS.008",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Transformation successful', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.success).to.be.true;",
									"    pm.expect(jsonData.transformedMessage).to.exist;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"CstmrCdtTrfInitn\": {\n        \"GrpHdr\": {\n            \"MsgId\": \"MSG-TRANSFORM-001\",\n            \"CreDtTm\": \"2025-10-10T12:00:00\",\n            \"NbOfTxs\": \"1\"\n        },\n        \"PmtInf\": {\n            \"Dbtr\": {\n                \"Nm\": \"Test Debtor\"\n            },\n            \"CdtTrfTxInf\": {\n                \"Amt\": {\n                    \"InstdAmt\": {\n                        \"Ccy\": \"USD\",\n                        \"Value\": 500.00\n                    }\n                },\n                \"Cdtr\": {\n                    \"Nm\": \"Test Creditor\"\n                }\n            }\n        }\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/payment-processing/api/v1/iso20022/comprehensive/transform/pain001-to-pacs008?tenantId={{tenantId}}&paymentType=CREDIT_TRANSFER&localInstrumentCode=IMMEDIATE",
							"host": ["{{base_url}}"],
							"path": ["payment-processing", "api", "v1", "iso20022", "comprehensive", "transform", "pain001-to-pacs008"],
							"query": [
								{
									"key": "tenantId",
									"value": "{{tenantId}}"
								},
								{
									"key": "paymentType",
									"value": "CREDIT_TRANSFER"
								},
								{
									"key": "localInstrumentCode",
									"value": "IMMEDIATE"
								}
							]
						}
					}
				},
				{
					"name": "Transform CAMT.055 to PACS.007",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"FIToFIPmtCxlReq\": {\n        \"GrpHdr\": {\n            \"MsgId\": \"CAMT055-001\",\n            \"CreDtTm\": \"2025-10-10T12:00:00\"\n        },\n        \"Undrlyg\": {\n            \"OrgnlGrpInfAndCxl\": {\n                \"OrgnlMsgId\": \"MSG-ORIGINAL-001\",\n                \"OrgnlMsgNmId\": \"pain.001.001.09\"\n            }\n        }\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/payment-processing/api/v1/iso20022/comprehensive/transform/camt055-to-pacs007?tenantId={{tenantId}}",
							"host": ["{{base_url}}"],
							"path": ["payment-processing", "api", "v1", "iso20022", "comprehensive", "transform", "camt055-to-pacs007"],
							"query": [
								{
									"key": "tenantId",
									"value": "{{tenantId}}"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "4. Cancellation & Status Requests",
			"item": [
				{
					"name": "Send CAMT.055 (Payment Cancellation)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"FIToFIPmtCxlReq\": {\n        \"GrpHdr\": {\n            \"MsgId\": \"CANCEL-{{$timestamp}}\",\n            \"CreDtTm\": \"{{$isoTimestamp}}\"\n        },\n        \"Undrlyg\": {\n            \"OrgnlGrpInfAndCxl\": {\n                \"OrgnlMsgId\": \"{{messageId}}\",\n                \"OrgnlMsgNmId\": \"pain.001.001.09\",\n                \"CxlRsnInf\": {\n                    \"Rsn\": {\n                        \"Cd\": \"DUPL\"\n                    }\n                }\n            }\n        }\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/payment-processing/api/v1/iso20022/comprehensive/camt055-to-clearing-system?tenantId={{tenantId}}&originalMessageId={{messageId}}&responseMode=IMMEDIATE",
							"host": ["{{base_url}}"],
							"path": ["payment-processing", "api", "v1", "iso20022", "comprehensive", "camt055-to-clearing-system"],
							"query": [
								{
									"key": "tenantId",
									"value": "{{tenantId}}"
								},
								{
									"key": "originalMessageId",
									"value": "{{messageId}}"
								},
								{
									"key": "responseMode",
									"value": "IMMEDIATE"
								}
							]
						}
					}
				},
				{
					"name": "Send CAMT.056 (Status Request)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"FIToFIPmtStsReq\": {\n        \"GrpHdr\": {\n            \"MsgId\": \"STATUS-{{$timestamp}}\",\n            \"CreDtTm\": \"{{$isoTimestamp}}\"\n        },\n        \"Undrlyg\": {\n            \"OrgnlGrpInfAndSts\": {\n                \"OrgnlMsgId\": \"{{messageId}}\",\n                \"OrgnlMsgNmId\": \"pain.001.001.09\"\n            }\n        }\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/payment-processing/api/v1/iso20022/comprehensive/camt056-to-clearing-system?tenantId={{tenantId}}&originalMessageId={{messageId}}&responseMode=IMMEDIATE",
							"host": ["{{base_url}}"],
							"path": ["payment-processing", "api", "v1", "iso20022", "comprehensive", "camt056-to-clearing-system"],
							"query": [
								{
									"key": "tenantId",
									"value": "{{tenantId}}"
								},
								{
									"key": "originalMessageId",
									"value": "{{messageId}}"
								},
								{
									"key": "responseMode",
									"value": "IMMEDIATE"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "5. Health & Monitoring",
			"item": [
				{
					"name": "ISO20022 Service Health",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/payment-processing/api/v1/iso20022/comprehensive/health",
							"host": ["{{base_url}}"],
							"path": ["payment-processing", "api", "v1", "iso20022", "comprehensive", "health"]
						}
					}
				},
				{
					"name": "Actuator Health",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/payment-processing/actuator/health",
							"host": ["{{base_url}}"],
							"path": ["payment-processing", "actuator", "health"]
						}
					}
				},
				{
					"name": "Actuator Metrics",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/payment-processing/actuator/metrics",
							"host": ["{{base_url}}"],
							"path": ["payment-processing", "actuator", "metrics"]
						}
					}
				},
				{
					"name": "Prometheus Metrics",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/payment-processing/actuator/prometheus",
							"host": ["{{base_url}}"],
							"path": ["payment-processing", "actuator", "prometheus"]
						}
					}
				}
			]
		}
	]
}
