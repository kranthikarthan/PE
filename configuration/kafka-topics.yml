# Kafka Topics Configuration
# Defines all Kafka topics used in the Payment Engine system

topics:
  # Transaction Events
  - name: "payment.transaction.created"
    partitions: 6
    replication_factor: 3
    config:
      retention.ms: 604800000 # 7 days
      cleanup.policy: delete
      compression.type: snappy
      min.insync.replicas: 2
    description: "Published when a new transaction is created"
    
  - name: "payment.transaction.updated"
    partitions: 6
    replication_factor: 3
    config:
      retention.ms: 604800000 # 7 days
      cleanup.policy: delete
      compression.type: snappy
      min.insync.replicas: 2
    description: "Published when a transaction status is updated"
    
  - name: "payment.transaction.completed"
    partitions: 6
    replication_factor: 3
    config:
      retention.ms: 2592000000 # 30 days
      cleanup.policy: delete
      compression.type: snappy
      min.insync.replicas: 2
    description: "Published when a transaction is completed"
    
  - name: "payment.transaction.failed"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 2592000000 # 30 days
      cleanup.policy: delete
      compression.type: snappy
      min.insync.replicas: 2
    description: "Published when a transaction fails"
    
  # Account Events
  - name: "payment.account.balance.updated"
    partitions: 6
    replication_factor: 3
    config:
      retention.ms: 604800000 # 7 days
      cleanup.policy: delete
      compression.type: snappy
      min.insync.replicas: 2
    description: "Published when account balance is updated"
    
  - name: "payment.account.created"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 7776000000 # 90 days
      cleanup.policy: delete
      compression.type: snappy
    description: "Published when a new account is created"
    
  - name: "payment.account.updated"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 2592000000 # 30 days
      cleanup.policy: delete
      compression.type: snappy
    description: "Published when account information is updated"
    
  # Notification Events
  - name: "payment.notification.email"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 86400000 # 1 day
      cleanup.policy: delete
      compression.type: snappy
    description: "Email notification requests"
    
  - name: "payment.notification.sms"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 86400000 # 1 day
      cleanup.policy: delete
      compression.type: snappy
    description: "SMS notification requests"
    
  - name: "payment.notification.push"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 86400000 # 1 day
      cleanup.policy: delete
      compression.type: snappy
    description: "Push notification requests"
    
  # Audit and Monitoring
  - name: "payment.audit.log"
    partitions: 12
    replication_factor: 3
    config:
      retention.ms: 7776000000 # 90 days
      cleanup.policy: delete
      compression.type: lz4
      min.insync.replicas: 2
    description: "Audit log events for compliance and tracking"
    
  - name: "payment.error.log"
    partitions: 6
    replication_factor: 3
    config:
      retention.ms: 2592000000 # 30 days
      cleanup.policy: delete
      compression.type: snappy
    description: "Error events for monitoring and alerting"
    
  - name: "payment.metrics"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 604800000 # 7 days
      cleanup.policy: delete
      compression.type: snappy
    description: "Business and technical metrics"
    
  # Security Events
  - name: "payment.security.login.attempt"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 2592000000 # 30 days
      cleanup.policy: delete
      compression.type: snappy
    description: "Login attempt events for security monitoring"
    
  - name: "payment.security.login.success"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 2592000000 # 30 days
      cleanup.policy: delete
      compression.type: snappy
    description: "Successful login events"
    
  - name: "payment.security.login.failure"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 2592000000 # 30 days
      cleanup.policy: delete
      compression.type: snappy
    description: "Failed login events for security monitoring"
    
  - name: "payment.security.fraud.detected"
    partitions: 6
    replication_factor: 3
    config:
      retention.ms: 7776000000 # 90 days
      cleanup.policy: delete
      compression.type: snappy
      min.insync.replicas: 2
    description: "Fraud detection alerts"
    
  # Dead Letter Topics
  - name: "payment.dlt.transaction"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 2592000000 # 30 days
      cleanup.policy: delete
      compression.type: snappy
    description: "Dead letter topic for failed transaction events"
    
  - name: "payment.dlt.notification"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 604800000 # 7 days
      cleanup.policy: delete
      compression.type: snappy
    description: "Dead letter topic for failed notification events"
    
  - name: "payment.dlt.audit"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 7776000000 # 90 days
      cleanup.policy: delete
      compression.type: snappy
    description: "Dead letter topic for failed audit events"
    
  # Retry Topics
  - name: "payment.retry.transaction"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 86400000 # 1 day
      cleanup.policy: delete
      compression.type: snappy
    description: "Retry topic for failed transaction processing"
    
  - name: "payment.retry.notification"
    partitions: 3
    replication_factor: 3
    config:
      retention.ms: 86400000 # 1 day
      cleanup.policy: delete
      compression.type: snappy
    description: "Retry topic for failed notifications"

# Topic Management Configuration
topic_management:
  auto_create_topics: true
  default_partitions: 3
  default_replication_factor: 3
  default_retention_ms: 604800000 # 7 days
  
  # Monitoring configuration
  monitoring:
    consumer_lag_threshold: 1000
    producer_throughput_threshold: 1000
    error_rate_threshold: 0.05
    
  # Cleanup policies
  cleanup:
    enable_log_compaction: false
    segment_size_mb: 1024
    segment_time_ms: 604800000 # 7 days
    
# Consumer Group Configuration
consumer_groups:
  - name: "core-banking-service"
    description: "Core banking service consumer group"
    topics: 
      - "payment.transaction.created"
      - "payment.transaction.updated"
      - "payment.account.balance.updated"
    
  - name: "payment-processing-service"
    description: "Payment Processing service consumer group"
    topics:
      - "payment.transaction.completed"
      - "payment.transaction.failed"
      - "payment.security.login.attempt"
    
  - name: "notification-service"
    description: "Notification service consumer group"
    topics:
      - "payment.notification.email"
      - "payment.notification.sms"
      - "payment.notification.push"
    
  - name: "audit-service"
    description: "Audit service consumer group"
    topics:
      - "payment.audit.log"
      - "payment.error.log"
    
  - name: "monitoring-service"
    description: "Monitoring service consumer group"
    topics:
      - "payment.metrics"
      - "payment.error.log"
    
  - name: "webhook-service"
    description: "Webhook delivery service consumer group"
    topics:
      - "payment.transaction.created"
      - "payment.transaction.completed"
      - "payment.transaction.failed"
      - "payment.account.balance.updated"