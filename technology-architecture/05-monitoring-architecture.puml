@startuml MONITORING_ARCHITECTURE
!theme plain
title ISO 20022 Payment Engine - Monitoring Architecture

package "Application Layer" {
    [Micrometer Metrics] as MM
    [Spring Boot Actuator] as SBA
    [Custom Metrics] as CM
    [Business Metrics] as BM
    [Health Checks] as HC
    [Circuit Breaker Metrics] as CBM
}

package "Infrastructure Layer" {
    [System Metrics] as SM
    [Container Metrics] as CM2
    [JVM Metrics] as JM
    [Database Metrics] as DM
    [Cache Metrics] as CacheM
}

package "Metrics Collection" {
    [Spring Boot Actuator] as SBA2
    [Micrometer Registry] as MR
    [Custom Metrics] as CM3
    [Metrics Storage] as MST
    [Metrics Aggregation] as MA
}

package "Log Collection" {
    [Structured Logging] as SL
    [JSON Logging] as JL
    [Log Aggregation] as LA
    [Log Parsing] as LP
    [Log Enrichment] as LE
}

package "Log Storage" {
    [File System] as FS
    [Log Retention] as LR
    [Log Archival] as LA2
    [Log Compression] as LC
    [Log Search] as LS2
}

package "Distributed Tracing" {
    [Trace Context] as TC
    [Span Management] as SM2
    [Trace Analysis] as TA
    [Trace Export] as TE
    [Trace Storage] as TS
}

package "Visualization" {
    [Custom Dashboards] as CD
    [Business Dashboards] as BD
    [Performance Dashboards] as PD
    [Health Dashboards] as HD
    [Security Dashboards] as SD
}

package "Alerting" {
    [Custom Alerts] as CA
    [Alert Rules] as AR
    [Alert Routing] as AR2
    [Alert Grouping] as AG
    [Notification Channels] as NC
}

package "Notification" {
    [Email Notifications] as EN
    [Slack Notifications] as SN
    [PagerDuty] as PD2
    [Webhook Notifications] as WN
    [SMS Notifications] as SMS
    [Teams Notifications] as TN
}

package "External Monitoring" {
    [Uptime Monitoring] as UM
    [Synthetic Monitoring] as SM2
    [Performance Monitoring] as PM
    [Error Tracking] as ET
    [User Experience] as UX
    [Business Intelligence] as BI
}

' Application layer connections
MM --> SBA : "Metrics Export"
SBA --> CM : "Custom Metrics"
CM --> BM : "Business Metrics"
BM --> HC : "Health Checks"
HC --> CBM : "Circuit Breaker Metrics"

' Infrastructure layer connections
SM --> JM : "JVM Metrics"
CM2 --> DM : "Database Metrics"
CM2 --> CacheM : "Cache Metrics"
JM --> DM : "Application Metrics"
DM --> CacheM : "Performance Metrics"

' Metrics collection connections
SBA2 --> MR : "Metrics Registry"
MR --> CM3 : "Custom Metrics"
CM3 --> MST : "Metrics Storage"
MST --> MA : "Metrics Aggregation"

MM --> SBA2 : "Application Metrics"
SM --> SBA2 : "System Metrics"
JM --> SBA2 : "JVM Metrics"
DM --> SBA2 : "Database Metrics"
CacheM --> SBA2 : "Cache Metrics"

' Log collection connections
SL --> LA : "Log Aggregation"
JL --> LA : "Log Aggregation"
LA --> LP : "Log Parsing"
LP --> LE : "Log Enrichment"
LE --> FS : "Log Storage"

' Log storage connections
FS --> LR : "Log Retention"
LR --> LA2 : "Log Archival"
LA2 --> LC : "Log Compression"
LC --> LS2 : "Log Search"

' Distributed tracing connections
TC --> SM2 : "Span Management"
SM2 --> TA : "Trace Analysis"
TA --> TE : "Trace Export"
TE --> TS : "Trace Storage"

MM --> TC : "Trace Data"
SBA --> TC : "Trace Data"

' Visualization connections
SBA2 --> CD : "Custom Dashboards"
MST --> BD : "Business Dashboards"
MA --> PD : "Performance Dashboards"
HC --> HD : "Health Dashboards"
CBM --> SD : "Security Dashboards"

' Alerting connections
SBA2 --> AR : "Alert Rules"
AR --> CA : "Custom Alerts"
CA --> AR2 : "Alert Routing"
AR2 --> AG : "Alert Grouping"
AG --> NC : "Notification Channels"

' Notification connections
NC --> EN : "Email Notifications"
NC --> SN : "Slack Notifications"
NC --> PD2 : "PagerDuty"
NC --> WN : "Webhook Notifications"
NC --> SMS : "SMS Notifications"
NC --> TN : "Teams Notifications"

' External monitoring connections
UM --> PS : "Uptime Metrics"
SM2 --> PS : "Synthetic Metrics"
PM --> PS : "Performance Metrics"
ET --> PS : "Error Metrics"
UX --> PS : "User Experience Metrics"
BI --> PS : "Business Intelligence"

note right of MM
Application Monitoring:
- Micrometer for metrics collection
- Spring Boot Actuator for health checks
- Custom business metrics
- Circuit breaker metrics
- Performance metrics
- Error metrics
- Throughput metrics
end note

note right of NE
Infrastructure Monitoring:
- Node Exporter for system metrics
- cAdvisor for container metrics
- kube-state-metrics for Kubernetes
- Prometheus Node Exporter
- System resource monitoring
- Container resource monitoring
- Network monitoring
end note

note right of PS
Metrics Collection:
- Prometheus for metrics storage
- Service discovery for targets
- Metrics scraping and collection
- Time series database
- Metrics aggregation
- Query language (PromQL)
- High availability
end note

note right of Fluentd
Log Collection:
- Fluentd for log aggregation
- Filebeat for log shipping
- Logstash for log processing
- Log parsing and enrichment
- Structured logging
- Log correlation
- Log filtering
end note

note right of ES
Log Storage:
- Elasticsearch for log storage
- Index management
- Log retention policies
- Log archival
- Log compression
- Full-text search
- Real-time analysis
end note

note right of JA
Distributed Tracing:
- Jaeger for distributed tracing
- Trace collection and storage
- Span correlation
- Performance analysis
- Dependency mapping
- Error tracking
- Request flow visualization
end note

note right of Grafana
Visualization:
- Grafana for dashboards
- Custom dashboards
- Business dashboards
- Performance dashboards
- Real-time visualization
- Historical analysis
- Multi-data source support
end note

note right of AM
Alerting:
- Alert Manager for alerting
- Alert rules and conditions
- Alert routing and grouping
- Alert silencing
- Notification channels
- Escalation policies
- Alert correlation
end note

note right of EN
Notification:
- Email notifications
- Slack integration
- PagerDuty integration
- Webhook notifications
- SMS notifications
- Teams notifications
- Multi-channel support
end note

note right of UM
External Monitoring:
- Uptime monitoring
- Synthetic monitoring
- Performance monitoring
- Error tracking
- User experience monitoring
- Business intelligence
- External service monitoring
end note

@enduml